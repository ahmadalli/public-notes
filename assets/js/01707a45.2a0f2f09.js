"use strict";(self.webpackChunkpublic_notes=self.webpackChunkpublic_notes||[]).push([[1686],{8730:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"projects/sre-audiobook","title":"SRE Audiobook","description":"Why","source":"@site/docs/0070-projects/020-sre-audiobook.md","sourceDirName":"0070-projects","slug":"/projects/sre-audiobook","permalink":"/projects/sre-audiobook","draft":false,"unlisted":false,"editUrl":"https://github.com/ahmadalli/public-notes/edit/main/docs/0070-projects/020-sre-audiobook.md","tags":[],"version":"current","lastUpdatedBy":"ahmadali shafiee","lastUpdatedAt":1693664543000,"sidebarPosition":20,"frontMatter":{"sidebar_position":20},"sidebar":"defaultSidebar","previous":{"title":"Public Notes","permalink":"/projects/public-notes"},"next":{"title":"Jumbled Projects","permalink":"/projects/jumbled-projects"}}');var o=s(4848),i=s(8453);const r={sidebar_position:20},a="SRE Audiobook",l={},c=[{value:"Why",id:"why",level:2},{value:"How",id:"how",level:2},{value:"What",id:"what",level:2},{value:"Challenges",id:"challenges",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"sre-audiobook",children:"SRE Audiobook"})}),"\n",(0,o.jsx)(t.h2,{id:"why",children:"Why"}),"\n",(0,o.jsx)(t.p,{children:"I wanted to listen to the SRE book while biking."}),"\n",(0,o.jsx)(t.h2,{id:"how",children:"How"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"I've already been using edge's built-in text-to-speech feature to listen to articles of the book and the quality of the text-to-speech service is good enough."}),"\n",(0,o.jsxs)(t.li,{children:["My podcast player, ",(0,o.jsx)(t.a,{href:"https://pocketcasts.com/",children:"Pocket Casts"}),", has great UX and I'm used to it. It can be used to play the audiobook if I publish it as a podcast."]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"what",children:"What"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"A podcast feed that contains the audio files of the book generated by the text-to-speech (TTS) service."}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"challenges",children:"Challenges"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\u25b6\ufe0f TTS services guess breaks and tone if you just give them the text.","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\u2611\ufe0f There's another input type that gives you more control: Speech Synthesis Markup Language (SSML). There are good docs for it from ",(0,o.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/ai-services/speech-service/speech-synthesis-markup",children:"Microsoft"})," and ",(0,o.jsx)(t.a,{href:"https://cloud.google.com/text-to-speech/docs/ssml",children:"Google"}),"."]}),"\n",(0,o.jsxs)(t.li,{children:["\u2611\ufe0f With ChatGPT's help, I came across ",(0,o.jsx)(t.code,{children:"HTMLParser"})," that can be used to parse the HTML and convert it to SSML."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\u25b6\ufe0f Google's TTS struggles with long sentences and requires more guidance. It failed to synthesize the audio for the Acknowledgments section of the book's ",(0,o.jsx)(t.a,{href:"https://sre.google/sre-book/preface/",children:"preface"})," because they were just a list of names. This issue has been reported in ",(0,o.jsx)(t.a,{href:"https://www.googlecloudcommunity.com/gc/AI-ML/Google-TTS-can-t-convert-text-longer-than-500-600-characters/m-p/517771",children:"here"})," as well.","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"\u2611\ufe0f I switched to Microsoft's TTS service and it worked fine."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"\u25b6\ufe0f GCP documentation for TTS service is not as good as Azure's."}),"\n",(0,o.jsx)(t.li,{children:"\u25b6\ufe0f Google's TTS service is more forgiving when it comes to SSML. It can handle invalid SSML and still generate the audio file. Microsoft's TTS service is more strict and won't generate the audio file if the SSML is invalid."}),"\n",(0,o.jsxs)(t.li,{children:["\u25b6\ufe0f TTS services has length limit for the generated output of the input text. They also offer long audio APIs but there's no support for SSML and they also require storage setup and won't return the audio file in the response.","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\u2611\ufe0f The input needs to be split into smaller chunks and each chunk needs to be sent to the TTS service separately. This was covered in the ",(0,o.jsx)(t.code,{children:"HTMLParser"})," code as well."]}),"\n",(0,o.jsx)(t.li,{children:"\u2611\ufe0f Chunks will be concatenated to generate the final audio file of each chapter."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\u25b6\ufe0f Sometimes the TTS service fails to generate the audio file and returns an error. Since the script runs on the whole book, restarting the script regenerate the whole book from the beginning.","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"\u2611\ufe0f I cache the generated chunks and chapters based on SHA256 of the input text. If the script fails, we can restart it and it will skip the chunks that have already been generated."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\u25b6\ufe0f Tables, images and graphs need to be converted to more proper format for the audiobook.","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"\u23f9\ufe0f For tables, I can repeat the column names for each row."}),"\n",(0,o.jsx)(t.li,{children:"\u23f9\ufe0f For images and graphs I can describe them using a image to text service and then use the text as the description of the image."}),"\n",(0,o.jsx)(t.li,{children:"\u23f9\ufe0f Images, graphs and tables can be referenced to their source URL from the audiobook."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\u25b6\ufe0f Nonlinear elements like ",(0,o.jsx)(t.code,{children:"<sub>"})," or footnotes need to be handled properly."]}),"\n",(0,o.jsx)(t.li,{children:"\u25b6\ufe0f Headers can be used as bookmark sections in the audiobook."}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>a});var n=s(6540);const o={},i=n.createContext(o);function r(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);